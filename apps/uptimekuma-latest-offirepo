#!/bin/bash

if [ -f "include/startup.sh" ]; then
    . include/startup.sh
elif [ -f "../include/startup.sh" ]; then
    . ../include/startup.sh
fi

rootDir=$(rootDir)

echo "Setting Hostname" | log
hostnamectl set-hostname ${CWM_DOMAIN}

echo "Creating UpTime-Kuma Volume" | log
docker volume create uptime-kuma

echo "Starting UpTime-Kuma container" | log
docker run -d --restart=always \
	-p 3001:3001
	-v /etc/letsencrypt/live/${CWM_DOMAIN}/fullchain.pem:/etc/rancher/ssl/cert.pem \
	-v /etc/letsencrypt/live/${CWM_DOMAIN}/privkey.pem:/etc/rancher/ssl/key.pem \
	-v /etc/letsencrypt/live/${CWM_DOMAIN}/chain.pem:/etc/rancher/ssl/cacerts.pem \
	-v uptime-kuma:/app/data --name uptime-kuma louislam/uptime-kuma:1

echo "Adding descriptions" | log
descriptionAppend "UpTime-Kuma Container: uptime-kuma"
descriptionAppend "Uptime-Kuma web UI: https://${CWM_DOMAIN}:3001"
descriptionAppend " "

tagScript success

exit 0
